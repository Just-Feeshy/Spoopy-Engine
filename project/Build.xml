<xml>
    <include name="${HXCPP}/build-tool/BuildCommon.xml"/>

    <set name="tool" value="exe" unless="iphone"/>
	<set name="tool" value="static" if="iphone"/>

    <set name="NATIVE_TOOLKIT_PATH" value="lib" unless="NATIVE_TOOLKIT_PATH" />

    <section if="windows">
        <include name="${HXCPP}/toolchain/msvc-toolchain.xml"/>
    </section>

    <section if="macos">
        <set name="HXCPP_CLANG" value="1" />
        <include name="${HXCPP}/toolchain/mac-toolchain.xml"/>
    </section>

    <section if="linux">
        <include name="${HXCPP}/toolchain/linux-toolchain.xml"/>
    </section>

    <files id="spoopy-engine">
        <compilerflag value="-Iinclude"/>

        <compilerflag value="-DENABLED_SDL" />

        <section unless="emscripten">
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/" />
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/default/" unless="windows || mac || linux || rpi"/>
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/linux/" if="linux" unless="rpi"/>
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/windows/" if="windows" unless="winrt"/>
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/mac/" if="mac"/>
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/rpi/" if="rpi"/>
            <compilerflag value="-I${NATIVE_TOOLKIT_PATH}/sdl/include/configs/winrt/" if="winrt"/>

            <section if="mac || ios">
                <compilerflag value="$-I{NATIVE_TOOLKIT_PATH}/metal-cpp/Foundation" />
                <compilerflag value="$-I{NATIVE_TOOLKIT_PATH}/metal-cpp/Metal" />
                <compilerflag value="$-I{NATIVE_TOOLKIT_PATH}/metal-cpp/QuartzCore" />
                <compilerflag value="$-I{NATIVE_TOOLKIT_PATH}/metal-cpp/SingleHeader" />

                <compilerflag value="-DSPOOPY_METAL" />
            </section>
        </section>

	    <file name="src/SpoopyEngine.cpp" />
    </files>

    <include name="lib/sdl/files.xml" />

    <target id="LIB" output="spoopy" tool="linker" toolid="${STD_MODULE_LINK}">
        <outdir name="../ndll/${BINDIR}"/>
        <files id="spoopy-engine" />

        <files id="native-toolkit-sdl" if="LIME_SDL" unless="emscripten" />

        <section unless="static_link">
            <ext value=".ndll" />
        </section>
    </target>

    <target id="default">
	    <target id="LIB" />
    </target>
</xml>